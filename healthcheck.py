from subprocess import run, PIPE

list_container=run(f"docker ps -a --format \'{{{{.Names}}}}\'", shell=True, stdout=PIPE, encoding='UTF-8').stdout.split(sep='\n')
for container in list_container:
    if "nginx" in container:

        command = f"docker inspect --format=\'{{{{json .State.Health}}}}\' \"{container}\" | jq \'.Status\'"

        healthcheck = run(f"{command}", shell=True, stdout=PIPE, encoding='UTF-8').stdout

        if 'unhealthy' in healthcheck:
            print(f"Container: {container}\n\033[31mSTATUS: Unhealthy\033[0m")
        elif 'healthy' in healthcheck:
            print(f"Container: {container}\n\033[32mSTATUS: Healthy\033[0m")
        else:
            print("wtf")
    else:
        continue





















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































